Fix error handling for rollback (efficient)
